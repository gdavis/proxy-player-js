/*	SWFObject v2.2 <http://code.google.com/p/swfobject/>
	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
*/
var swfobject=function(){var D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=false,U=[h],o=[],N=[],I=[],l,Q,E,B,J=false,a=false,n,G,m=true,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=Y?/win/.test(Y):/win/.test(ah),ac=Y?/mac/.test(Y):/mac/.test(ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,X=!+"\v1",ag=[0,0,0],ab=null;if(typeof t.plugins!=D&&typeof t.plugins[S]==r){ab=t.plugins[S].description;if(ab&&!(typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin)){T=true;X=false;ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1");ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10);ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10);ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof O.ActiveXObject!=D){try{var ad=new ActiveXObject(W);if(ad){ab=ad.GetVariable("$version");if(ab){X=true;ab=ab.split(" ")[1].split(",");ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}}catch(Z){}}}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac}}(),k=function(){if(!M.w3){return}if((typeof j.readyState!=D&&j.readyState=="complete")||(typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))){f()}if(!J){if(typeof j.addEventListener!=D){j.addEventListener("DOMContentLoaded",f,false)}if(M.ie&&M.win){j.attachEvent(x,function(){if(j.readyState=="complete"){j.detachEvent(x,arguments.callee);f()}});if(O==top){(function(){if(J){return}try{j.documentElement.doScroll("left")}catch(X){setTimeout(arguments.callee,0);return}f()})()}}if(M.wk){(function(){if(J){return}if(!/loaded|complete/.test(j.readyState)){setTimeout(arguments.callee,0);return}f()})()}s(f)}}();function f(){if(J){return}try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));Z.parentNode.removeChild(Z)}catch(aa){return}J=true;var X=U.length;for(var Y=0;Y<X;Y++){U[Y]()}}function K(X){if(J){X()}else{U[U.length]=X}}function s(Y){if(typeof O.addEventListener!=D){O.addEventListener("load",Y,false)}else{if(typeof j.addEventListener!=D){j.addEventListener("load",Y,false)}else{if(typeof O.attachEvent!=D){i(O,"onload",Y)}else{if(typeof O.onload=="function"){var X=O.onload;O.onload=function(){X();Y()}}else{O.onload=Y}}}}}function h(){if(T){V()}else{H()}}function V(){var X=j.getElementsByTagName("body")[0];var aa=C(r);aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;(function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");if(ab){ab=ab.split(" ")[1].split(",");M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}else{if(Y<10){Y++;setTimeout(arguments.callee,10);return}}X.removeChild(aa);Z=null;H()})()}else{H()}}function H(){var ag=o.length;if(ag>0){for(var af=0;af<ag;af++){var Y=o[af].id;var ab=o[af].callbackFn;var aa={success:false,id:Y};if(M.pv[0]>0){var ae=c(Y);if(ae){if(F(o[af].swfVersion)&&!(M.wk&&M.wk<312)){w(Y,true);if(ab){aa.success=true;aa.ref=z(Y);ab(aa)}}else{if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall;ai.width=ae.getAttribute("width")||"0";ai.height=ae.getAttribute("height")||"0";if(ae.getAttribute("class")){ai.styleclass=ae.getAttribute("class")}if(ae.getAttribute("align")){ai.align=ae.getAttribute("align")}var ah={};var X=ae.getElementsByTagName("param");var ac=X.length;for(var ad=0;ad<ac;ad++){if(X[ad].getAttribute("name").toLowerCase()!="movie"){ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value")}}P(ai,ah,Y,ab)}else{p(ae);if(ab){ab(aa)}}}}}else{w(Y,true);if(ab){var Z=z(Y);if(Z&&typeof Z.SetVariable!=D){aa.success=true;aa.ref=Z}ab(aa)}}}}}function z(aa){var X=null;var Y=c(aa);if(Y&&Y.nodeName=="OBJECT"){if(typeof Y.SetVariable!=D){X=Y}else{var Z=Y.getElementsByTagName(r)[0];if(Z){X=Z}}}return X}function A(){return !a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312)}function P(aa,ab,X,Z){a=true;E=Z||null;B={success:false,id:X};var ae=c(X);if(ae){if(ae.nodeName=="OBJECT"){l=g(ae);Q=null}else{l=ae;Q=X}aa.id=R;if(typeof aa.width==D||(!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)){aa.width="310"}if(typeof aa.height==D||(!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)){aa.height="137"}j.title=j.title.slice(0,47)+" - Flash Player Installation";var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D){ab.flashvars+="&"+ac}else{ab.flashvars=ac}if(M.ie&&M.win&&ae.readyState!=4){var Y=C("div");X+="SWFObjectNew";Y.setAttribute("id",X);ae.parentNode.insertBefore(Y,ae);ae.style.display="none";(function(){if(ae.readyState==4){ae.parentNode.removeChild(ae)}else{setTimeout(arguments.callee,10)}})()}u(aa,ab,X)}}function p(Y){if(M.ie&&M.win&&Y.readyState!=4){var X=C("div");Y.parentNode.insertBefore(X,Y);X.parentNode.replaceChild(g(Y),X);Y.style.display="none";(function(){if(Y.readyState==4){Y.parentNode.removeChild(Y)}else{setTimeout(arguments.callee,10)}})()}else{Y.parentNode.replaceChild(g(Y),Y)}}function g(ab){var aa=C("div");if(M.win&&M.ie){aa.innerHTML=ab.innerHTML}else{var Y=ab.getElementsByTagName(r)[0];if(Y){var ad=Y.childNodes;if(ad){var X=ad.length;for(var Z=0;Z<X;Z++){if(!(ad[Z].nodeType==1&&ad[Z].nodeName=="PARAM")&&!(ad[Z].nodeType==8)){aa.appendChild(ad[Z].cloneNode(true))}}}}}return aa}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312){return X}if(aa){if(typeof ai.id==D){ai.id=Y}if(M.ie&&M.win){var ah="";for(var ae in ai){if(ai[ae]!=Object.prototype[ae]){if(ae.toLowerCase()=="data"){ag.movie=ai[ae]}else{if(ae.toLowerCase()=="styleclass"){ah+=' class="'+ai[ae]+'"'}else{if(ae.toLowerCase()!="classid"){ah+=" "+ae+'="'+ai[ae]+'"'}}}}}var af="";for(var ad in ag){if(ag[ad]!=Object.prototype[ad]){af+='<param name="'+ad+'" value="'+ag[ad]+'" />'}}aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>";N[N.length]=ai.id;X=c(ai.id)}else{var Z=C(r);Z.setAttribute("type",q);for(var ac in ai){if(ai[ac]!=Object.prototype[ac]){if(ac.toLowerCase()=="styleclass"){Z.setAttribute("class",ai[ac])}else{if(ac.toLowerCase()!="classid"){Z.setAttribute(ac,ai[ac])}}}}for(var ab in ag){if(ag[ab]!=Object.prototype[ab]&&ab.toLowerCase()!="movie"){e(Z,ab,ag[ab])}}aa.parentNode.replaceChild(Z,aa);X=Z}}return X}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X);aa.setAttribute("value",Y);Z.appendChild(aa)}function y(Y){var X=c(Y);if(X&&X.nodeName=="OBJECT"){if(M.ie&&M.win){X.style.display="none";(function(){if(X.readyState==4){b(Y)}else{setTimeout(arguments.callee,10)}})()}else{X.parentNode.removeChild(X)}}}function b(Z){var Y=c(Z);if(Y){for(var X in Y){if(typeof Y[X]=="function"){Y[X]=null}}Y.parentNode.removeChild(Y)}}function c(Z){var X=null;try{X=j.getElementById(Z)}catch(Y){}return X}function C(X){return j.createElement(X)}function i(Z,X,Y){Z.attachEvent(X,Y);I[I.length]=[Z,X,Y]}function F(Z){var Y=M.pv,X=Z.split(".");X[0]=parseInt(X[0],10);X[1]=parseInt(X[1],10)||0;X[2]=parseInt(X[2],10)||0;return(Y[0]>X[0]||(Y[0]==X[0]&&Y[1]>X[1])||(Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]))?true:false}function v(ac,Y,ad,ab){if(M.ie&&M.mac){return}var aa=j.getElementsByTagName("head")[0];if(!aa){return}var X=(ad&&typeof ad=="string")?ad:"screen";if(ab){n=null;G=null}if(!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css");Z.setAttribute("media",X);n=aa.appendChild(Z);if(M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0){n=j.styleSheets[j.styleSheets.length-1]}G=X}if(M.ie&&M.win){if(n&&typeof n.addRule==r){n.addRule(ac,Y)}}else{if(n&&typeof j.createTextNode!=D){n.appendChild(j.createTextNode(ac+" {"+Y+"}"))}}}function w(Z,X){if(!m){return}var Y=X?"visible":"hidden";if(J&&c(Z)){c(Z).style.visibility=Y}else{v("#"+Z,"visibility:"+Y)}}function L(Y){var Z=/[\\\"<>\.;]/;var X=Z.exec(Y)!=null;return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y}var d=function(){if(M.ie&&M.win){window.attachEvent("onunload",function(){var ac=I.length;for(var ab=0;ab<ac;ab++){I[ab][0].detachEvent(I[ab][1],I[ab][2])}var Z=N.length;for(var aa=0;aa<Z;aa++){y(N[aa])}for(var Y in M){M[Y]=null}M=null;for(var X in swfobject){swfobject[X]=null}swfobject=null})}}();return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab;Y.swfVersion=X;Y.expressInstall=aa;Y.callbackFn=Z;o[o.length]=Y;w(ab,false)}else{if(Z){Z({success:false,id:ab})}}},getObjectById:function(X){if(M.w3){return z(X)}},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:false,id:ah};if(M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y){w(ah,false);K(function(){ae+="";ag+="";var aj={};if(af&&typeof af===r){for(var al in af){aj[al]=af[al]}}aj.data=ab;aj.width=ae;aj.height=ag;var am={};if(ad&&typeof ad===r){for(var ak in ad){am[ak]=ad[ak]}}if(Z&&typeof Z===r){for(var ai in Z){if(typeof am.flashvars!=D){am.flashvars+="&"+ai+"="+Z[ai]}else{am.flashvars=ai+"="+Z[ai]}}}if(F(Y)){var an=u(aj,am,ah);if(aj.id==ah){w(ah,true)}X.success=true;X.ref=an}else{if(aa&&A()){aj.data=aa;P(aj,am,ah,ac);return}else{w(ah,true)}}if(ac){ac(X)}})}else{if(ac){ac(X)}}},switchOffAutoHideShow:function(){m=false},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){if(M.w3){return u(Z,Y,X)}else{return undefined}},showExpressInstall:function(Z,aa,X,Y){if(M.w3&&A()){P(Z,aa,X,Y)}},removeSWF:function(X){if(M.w3){y(X)}},createCSS:function(aa,Z,Y,X){if(M.w3){v(aa,Z,Y,X)}},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;if(Z){if(/\?/.test(Z)){Z=Z.split("?")[1]}if(aa==null){return L(Z)}var Y=Z.split("&");for(var X=0;X<Y.length;X++){if(Y[X].substring(0,Y[X].indexOf("="))==aa){return L(Y[X].substring((Y[X].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(a){var X=c(R);if(X&&l){X.parentNode.replaceChild(l,X);if(Q){w(Q,true);if(M.ie&&M.win){l.style.display="block"}}if(E){E(B)}}a=false}}}}();

/*
 * Proxy Player 0.0.1
 * http://github.com/gdavis/proxy-player-js
 *
 * Copyright (c) 2011 Grant Davis
 *
 * Released under the MIT License
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
 * documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of
 * the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
 * WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS
 * OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * @version: 0.0.1
 * @author: Grant Davis <grant.davis@gmail.com>
 */
var object={getType:function(a){switch(a){case null:return"Null";case void 0:return"Undefined"}switch(typeof a){case "boolean":return"Boolean";case "number":return"Number";case "string":return"String"}return"Object"},keys:function(a){this.getType(a)!=="Object"&&alert("type error");var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b},isFunction:function(a){return Object.prototype.toString.call(a)==="[object Function]"},isUndefined:function(a){return typeof a==="undefined"},extend:function(a,
b){for(var c in b)a[c]=b[c];return a}};function $A(a){if(!a)return[];if("toArray"in Object(a))return a.toArray();for(var b=a.length||0,c=Array(b);b--;)c[b]=a[b];return c}Function.prototype.argumentNames=function(){var a=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return a.length==1&&!a[0]?[]:a};
Function.prototype.bind=function(a){if(arguments.length<2&&object.isUndefined(arguments[0]))return this;var b=this,c=Array.prototype.slice.call(arguments,1);return function(){var d=c,e=arguments;d=d=Array.prototype.slice.call(d,0);for(var f=d.length,g=e.length;g--;)d[f+g]=e[g];return b.apply(a,d)}};Function.prototype.wrap=function(a){var b=this;return function(){for(var c=[b.bind(this)],d=arguments,e=c.length,f=d.length;f--;)c[e+f]=d[f];return a.apply(this,c)}};
var Class=function(){function a(d,e){for(var f in e)d[f]=e[f];return d}function b(){}var c=function(){for(var d in{toString:1})if(d==="toString")return false;return true}();return{create:function(){function d(){this.initialize.apply(this,arguments)}var e=null,f=$A(arguments);if(object.isFunction(f[0]))e=f.shift();a(d,Class.Methods);d.superclass=e;d.subclasses=[];if(e){b.prototype=e.prototype;d.prototype=new b;e.subclasses.push(d)}e=0;for(var g=f.length;e<g;e++)d.addMethods(f[e]);if(!d.prototype.initialize)d.prototype.initialize=
Prototype.emptyFunction;return d.prototype.constructor=d},extend:a,Methods:{addMethods:function(d){var e=this.superclass&&this.superclass.prototype,f=object.keys(d);if(c){d.toString!=Object.prototype.toString&&f.push("toString");d.valueOf!=Object.prototype.valueOf&&f.push("valueOf")}for(var g=0,i=f.length;g<i;g++){var h=f[g],j=d[h];if(e&&object.isFunction(j)&&j.argumentNames()[0]=="$super"){var k=j;j=function(l){return function(){return e[l].apply(this,arguments)}}(h).wrap(k);j.valueOf=k.valueOf.bind(k);
j.toString=k.toString.bind(k)}this.prototype[h]=j}return this}}}}();Function.prototype.context=function(a){var b=this;if(this.hasContextMethod(this,a))return this.getContextMethod(this,a);else{var c=function(){return b.apply(a,arguments)};c.scope=a;if(this.contextMethods===undefined)this.contextMethods=[];this.contextMethods.push(c);return c}};Function.prototype.hasContextMethod=function(a,b){if(a.contextMethods)for(var c=0;c<a.contextMethods.length;c++){if(a.contextMethods[c].scope===b)return true}else return false};
Function.prototype.getContextMethod=function(a,b){if(this.hasContextMethod(a,b))for(var c=0;c<a.contextMethods.length;c++)if(a.contextMethods[c].scope===b)return a.contextMethods[c]};function DOMUtil(){}DOMUtil.getWidth=function(a){return a?a.offsetWidth:-1};DOMUtil.getHeight=function(a){return a?a.offsetHeight:-1};DOMUtil.show=function(a){if(a)a.style.display="inline"};DOMUtil.hide=function(a){if(a)a.style.display="none"};DOMUtil.removeElement=function(a){a&&a.parentNode&&a.parentNode.removeChild(a)};
DOMUtil.createElement=function(a,b,c){a=a||b.tag;var d;a=document.createElement(a);for(d in b)if(typeof b[d]!=="function")switch(d){case "text":a.appendChild(document.createTextNode(b[d]));break;case "className":a.className=b[d];break;default:a.setAttribute(d,b[d])}c&&c.appendChild(a);return a};DOMUtil.getRE=function(a){return RegExp("\\b"+a+"\\b","g")};DOMUtil.hasClass=function(a,b){return this.getRE(b).test(a.className)};DOMUtil.addClass=function(a,b){this.hasClass(a,b)||(a.className+=" "+b)};
DOMUtil.removeClass=function(a,b){a.className=a.className.replace(this.getRE(b),"")};DOMUtil.toggleClass=function(a,b,c){if(c===undefined)c=!this.hasClass(a,b);c?this.addClass(a,b):this.removeClass(a,b)};function EnvironmentUtil(){}EnvironmentUtil.iPhone=navigator.userAgent.match(/iPhone/i)!==null;EnvironmentUtil.iPod=navigator.userAgent.match(/iPod/i)!==null;EnvironmentUtil.iPad=navigator.userAgent.match(/iPad/i)!==null;EnvironmentUtil.iOS=EnvironmentUtil.iPhone||EnvironmentUtil.iPod||EnvironmentUtil.iPad;
EnvironmentUtil.iOS_3=EnvironmentUtil.iOS&&navigator.userAgent.match(/OS 3/i)!==null;EnvironmentUtil.iOS_4=EnvironmentUtil.iOS&&navigator.userAgent.match(/OS 4/i)!==null;EnvironmentUtil.chrome=navigator.userAgent.match(/Chrome/i)!==null;EnvironmentUtil.safari=navigator.userAgent.match(/Safari/i)!==null;EnvironmentUtil.android=navigator.userAgent.match(/Android/i)!==null;EnvironmentUtil.android_2_1=navigator.userAgent.match(/Android 2.1/i)!==null;
EnvironmentUtil.andriod_2_2=navigator.userAgent.match(/Android 2.2/i)!==null;EnvironmentUtil.ie=navigator.userAgent.match(/MSIE/i)!==null;EnvironmentUtil.ie6=navigator.userAgent.match(/MSIE 6/i)!==null;EnvironmentUtil.ie7=navigator.userAgent.match(/MSIE 8/i)!==null;EnvironmentUtil.firefox=navigator.userAgent.match(/Firefox/i)!==null;EnvironmentUtil.firefox_3=navigator.userAgent.match(/Firefox\/3/i)!==null;var EventUtil={};
EventUtil.dispatch=function(){var a,b,c;if(arguments.length==1){a=document;b=arguments[0]}if(arguments.length>1){a=arguments[0];b=arguments[1]}if(a.fireEvent)try{a.fireEvent(b)}catch(d){c=document.createEventObject();c.type=b;c.target=a;if(EventUtil.events&&EventUtil.events[b])for(var e in EventUtil.events[b])EventUtil.events[b][e].call(a,c)}else if(document.createEvent){c=document.createEvent("HTMLEvents");c.initEvent&&c.initEvent(b,true,true);a.dispatchEvent&&a.dispatchEvent(c)}};
EventUtil.bind=function(a,b){if(b.addEventListener)return function(c,d,e){c.addEventListener(d,e,false)};else if(b.attachEvent){EventUtil.events={};EventUtil.objectIDs=[];return function(c,d,e){if(c&&d&&e){EventUtil.events[d]||(EventUtil.events[d]={});var f=function(g){return e.call(c,g)};EventUtil.events[d][EventUtil.getIDForObject(e)]=f;c.attachEvent("on"+d,f)}}}}(this,document);
EventUtil.unbind=function(a,b){if(b.removeEventListener)return function(c,d,e){c.removeEventListener(d,e,false)};else if(b.detachEvent)return function(c,d,e){c.detachEvent("on"+d,EventUtil.events[d][EventUtil.getIDForObject(e)]);delete EventUtil.events[d][EventUtil.getIDForObject(e)]}}(this,document);
EventUtil.documentReady=function(a,b){return/WebKit/i.test(navigator.userAgent)?function(c){var d=setInterval(function(){if(/loaded|complete/.test(b.readyState)){clearInterval(d);c.call(b)}},10)}:/MSIE/i.test(navigator.userAgent)?function(c){b.write("<script id=__ie_onload defer src=javascript:void(0)><\/script>");b.getElementById("__ie_onload").onreadystatechange=function(){this.readyState=="complete"&&c.call(b)}}:function(c){EventUtil.bind(b,"DOMContentLoaded",c)}}(this,document);
EventUtil.getIDForObject=function(a){for(var b=EventUtil.objectIDs,c=b.length,d=0;d<c;d++)if(b[d]===a)return d;b=EventUtil.objectIDs.length;EventUtil.objectIDs.push(a);return b};
var PPControl=Class.create({initialize:function(a,b,c){this.model=a;this.controller=b;this.container=c;this.element=undefined},canSupportPlatform:function(){return EnvironmentUtil.iPhone||EnvironmentUtil.android?false:true},resizeType:function(){return PPControl.TYPE_FIXED},build:function(){this.element=DOMUtil.createElement("div",{className:this.resizeType()},this.container)},setListeners:function(){},update:function(){},destroy:function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);
delete this.element;delete this.controller;delete this.container}});PPControl.TYPE_FLEXIBLE="pp-flexible";PPControl.TYPE_FIXED="pp-fixed";PPVideoEvent={};PPVideoEvent.RESIZE="PPVideoEvent.resize";PPVideoEvent.COMPLETE="PPVideoEvent.complete";PPVideoEvent.METADATA="PPVideoEvent.metadata";PPVideoEvent.TIME_UPDATE="PPVideoEvent.timeUpdate";PPVideoEvent.PLAYER_READY="PPVideoEvent.playerReady";PPVideoEvent.LOAD_PROGRESS="PPVideoEvent.loadProgress";PPVideoEvent.VOLUME_UPDATE="PPVideoEvent.volumeUpdate";
PPVideoEvent.PLAY_STATE_CHANGE="PPVideoEvent.playStateChange";PPVideoEvent.TOGGLE_FULLSCREEN="PPVideoEvent.toggleFullscreen";PPVideoEvent.STATE_CHANGE="PPVideoEvent.stateChange";
var PPVideoModel=Class.create({initialize:function(a){this.dispatcher=a;this.init()},init:function(){this._volume=1;this._height=this._width=0;this.reset()},reset:function(){this._duration=this._time=0;this._state=this._playing=false;this._bytesTotal=this._bytesLoaded=0;this._fullscreen=false},setSize:function(a,b){if(!(this._width==a&&this._height==b)){this._width=a;this._height=b;EventUtil.dispatch(this.dispatcher,PPVideoEvent.RESIZE)}},getWidth:function(){return this._width},setWidth:function(a){if(this._width!==
a){this._width=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.RESIZE)}},getHeight:function(){return this._height},setHeight:function(a){if(this._height!==a){this._height=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.RESIZE)}},getVolume:function(){return this._volume},setVolume:function(a){a=parseFloat(a);a=a>1?1:a<0?0:a;if(this._volume!=a){this._volume=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.VOLUME_UPDATE)}},getTime:function(){return this._time},setTime:function(a){if(this._time!=
a){this._time=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.TIME_UPDATE)}},getDuration:function(){return this._duration},setDuration:function(a){if(this._duration!=a){this._duration=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.TIME_UPDATE)}},getPlaying:function(){return this._playing},setPlaying:function(a){if(this._playing!=a){this._playing=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.PLAY_STATE_CHANGE)}},getState:function(){return this._state},setState:function(a){if(this._state!==
a){this._state=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.STATE_CHANGE)}},getBytesLoaded:function(){return this._bytesLoaded},setBytesLoaded:function(a){if(this._bytesLoaded!=a){this._bytesLoaded=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.LOAD_PROGRESS)}},getBytesTotal:function(){return this._bytesTotal},setBytesTotal:function(a){if(this._bytesTotal!=a){this._bytesTotal=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.LOAD_PROGRESS)}},getFullscreen:function(){return this._fullscreen},
setFullscreen:function(a){if(this._fullscreen!=a){this._fullscreen=a;EventUtil.dispatch(this.dispatcher,PPVideoEvent.TOGGLE_FULLSCREEN)}}}),PPControls=Class.create({initialize:function(a,b,c,d,e){this.model=a;this.controller=b;this.container=c;this.controls=[];this.overlays=[];this.overlayContainer=DOMUtil.createElement("div",{className:"pp-overlays"},this.container);this.controlBar=DOMUtil.createElement("div",{className:"pp-control-bar"},this.container);this.container.onmousedown=function(){return false};
this.container.onselectstart=function(){return false};EnvironmentUtil.android&&EventUtil.bind(this.controller.container,"click",this.controller.play.context(this.controller));b=d.length;for(a=0;a<b;a++)if(c=this.createControl(d[a],this.controlBar)){DOMUtil.addClass(c.element,"pp-control");this.controls.push(c)}b=e.length;for(a=0;a<b;a++)if(d=this.createControl(e[a],this.overlayContainer)){DOMUtil.addClass(d.element,"pp-overlay");this.overlays.push(d)}this.setListeners();this.position()},destroy:function(){if(EnvironmentUtil.android||
EnvironmentUtil.iPad&&EnvironmentUtil.iOS_3)EventUtil.unbind(this.controller.container,"click",this.controller.play.context(this.controller));EventUtil.unbind(this.model.dispatcher,PPVideoEvent.RESIZE,this.position.context(this));var a,b=this.controls.length;for(a=0;a<b;a++){var c=this.controls[a];typeof c=="function"&&c.destroy()}for(a=0;a<b;a++){c=this.overlays[a];typeof c=="function"&&c.destroy()}},createControl:function(a,b){var c=this.constructControl(a,b);if(c.canSupportPlatform()){c.build();
c.setListeners();c.update();return c}delete c;return false},constructControl:function(a,b){var c;if(typeof a==="string")c=new window[a](this.model,this.controller,b);else if(typeof a==="function")c=new a(this.model,this.controller,b);return c},setListeners:function(){EventUtil.bind(this.model.dispatcher,PPVideoEvent.RESIZE,this.position.context(this))},position:function(){var a,b=this.controls.length,c=[],d=0,e;for(e=0;e<b;e++){a=this.controls[e];a=a.tagName!==undefined?a:a.element;if(DOMUtil.hasClass(a,
"pp-flexible"))c.push(a);else d+=a.offsetWidth}b=c.length;d=(this.model.getWidth()-d)/b;for(e=0;e<b;e++)c[e].style.width=d+"px";b=this.overlays.length;for(e=0;e<b;e++){c=this.overlays[e];a=c.tagName!==undefined?c:c.element;a.style.width=this.model.getWidth()+"px";a.style.height=this.model.getHeight()+"px"}}}),PPVideoConfiguration=Class.create({initialize:function(a,b,c,d,e,f,g){d=d||PPVideoConfiguration.DEFAULT_SWF;e=e||{};this.width=a||320;this.height=b||240;this.videoOptions=PPVideoConfiguration.mergeOptions(PPVideoConfiguration.DEFAULT_VIDEO_OPTIONS,
c);this.videoOptions.width=this.width;this.videoOptions.height=this.height;this.flashOptions={expressInstall:"expressinstall.swf",version:"10",swf:d,variables:e,params:PPVideoConfiguration.mergeOptions(PPVideoConfiguration.DEFAULT_FLASH_PARAMS,f),attributes:PPVideoConfiguration.mergeOptions(PPVideoConfiguration.DEFAULT_FLASH_ATTRIBUTES,g)}}});PPVideoConfiguration.DEFAULT_SWF="PPProxy-player.swf";PPVideoConfiguration.DEFAULT_FLASH_ATTRIBUTES={bgcolor:"#000"};
PPVideoConfiguration.DEFAULT_VIDEO_OPTIONS={audio:false,autoplay:false,autobuffer:false,controls:false,loop:false,preload:false,src:false,poster:false,volume:1};PPVideoConfiguration.DEFAULT_FLASH_PARAMS={scale:"noscale",allowScriptAccess:"always",quality:"best",wmode:"transparent",allowFullScreen:"true"};
PPVideoConfiguration.mergeOptions=function(a,b){if(b===undefined)return a;var c={},d;for(d in a)c[d]=a[d];for(d in b)c[d]=typeof b[d]==="object"?PPVideoConfiguration.mergeOptions(a[d],b[d]):b[d];return c};PPVideoState={};PPVideoState.READY="ready";PPVideoState.ERROR="error";PPVideoState.PAUSED="paused";PPVideoState.LOADING="loading";PPVideoState.PLAYING="playing";PPVideoState.STOPPED="stopped";PPVideoState.SEEKING="seeking";PPVideoState.BUFFERING="buffering";
var ProxyPlayerSources=Class.create({initialize:function(){this.videos=[];this.flashVideo=""},addVideo:function(a,b,c,d){this.videos.push(new ProxyPlayerSource(a,b,c));if(d=="true"||d)this.flashVideo=a}}),ProxyPlayerSource=Class.create({initialize:function(a,b,c){this.file=a;this.type=b;this.label=c}}),PPProxy=Class.create({initialize:function(a,b,c){this.model=a;this.controller=b;this.video=c;this.setListeners()},destroy:function(){delete this.model;delete this.controller;delete this.video},load:function(){},
play:function(){},pause:function(){},stop:function(){},seek:function(){},setWidth:function(){},setHeight:function(){},getVolume:function(){},setVolume:function(){},setTime:function(){},isPlaying:function(){},setListeners:function(){},resize:function(){}}),HTMLVideoProxy=Class.create(PPProxy,{initialize:function($super,b,c,d){this.bufferInterval=false;this.videoEvents=[{type:"metadata",handler:this.handleMetadata.context(this)},{type:"loadstart",handler:this.handleLoadStart.context(this)},{type:"loadeddata",
handler:this.handleBuffering.context(this)},{type:"waiting",handler:this.handleBuffering.context(this)},{type:"error",handler:this.handleError.context(this)},{type:"progress",handler:this.handleProgress.context(this)},{type:"play",handler:this.handlePlay.context(this)},{type:"playing",handler:this.handlePlay.context(this)},{type:"pause",handler:this.handlePause.context(this)},{type:"seeking",handler:this.handleSeek.context(this)},{type:"seeked",handler:this.handleSeeked.context(this)},{type:"ended",
handler:this.handleEnd.context(this)},{type:"volumechange",handler:this.handleVolume.context(this)},{type:"timeupdate",handler:this.handleTimeUpdate.context(this)},{type:"durationchange",handler:this.handleDurationChange.context(this)}];this.modelEvents=[{type:PPVideoEvent.RESIZE,handler:this.resize.context(this)},{type:PPVideoEvent.VOLUME_UPDATE,handler:this._updateVolume.context(this)}];$super(b,c,d);this.setVolume(this.model.getVolume());this.resize()},destroy:function($super){var b,c,d=this.videoEvents.length;
for(c=0;c<d;c++){b=this.videoEvents[c];EventUtil.unbind(this.video,b.type,b.handler)}d=this.modelEvents.length;for(c=0;c<d;c++){b=this.modelEvents[c];EventUtil.unbind(this.model.dispatcher,b.type,b.handler)}delete this.videoEvents;delete this.modelEvents;clearInterval(this.bufferInterval);$super()},load:function(a){if(a!==undefined)this.video.src=a;this.video.load()},play:function(a){if(a!==undefined)this.video.src=a;this.video.play()},pause:function(){this.video.pause()},stop:function(){this.video.pause();
if(this.video.currentTime>0)this.video.currentTime=0},seek:function(a){this.video.currentTime=a},setWidth:function(a){this.video.width=parseInt(a)},setHeight:function(a){this.video.height=parseInt(a)},getVolume:function(){return this.video.volume},setVolume:function(a){this.video.volume=parseFloat(a)},getTime:function(){return this.video.currentTime},isPlaying:function(){return!this.video.paused},setListeners:function(){var a,b,c=this.videoEvents.length;for(b=0;b<c;b++){a=this.videoEvents[b];EventUtil.bind(this.video,
a.type,a.handler)}c=this.modelEvents.length;for(b=0;b<c;b++){a=this.modelEvents[b];EventUtil.bind(this.model.dispatcher,a.type,a.handler)}},_updateVolume:function(){this.setVolume(this.model.getVolume())},resize:function(){this.video.width=parseInt(this.model.getWidth());this.video.height=parseInt(this.model.getHeight())},startBufferInterval:function(){this.bufferInterval=setInterval(this.handleProgress.context(this),10)},handleDurationChange:function(){this.controller._updateDuration(this.video.duration)},
handleMetadata:function(){},handleError:function(a){this.controller._updatePlayerState(PPVideoState.ERROR);a.target.networkState===4&&this.controller.fallback()},handleTimeUpdate:function(){this.controller._updatePlayheadTime(this.video.currentTime)},handleProgress:function(a){if(this.video.buffered){if(this.video.buffered.length>0){this.controller._updateLoadProgress(this.video.buffered.end(0),this.video.duration);this.video.buffered.end(0)==this.video.duration&&clearInterval(this.bufferInterval)}}else a&&
a.loaded&&a.total&&this.controller._updateLoadProgress(a.loaded,a.total)},handleLoadStart:function(){this.controller._updatePlayerState(PPVideoState.LOADING)},handleBuffering:function(){this.controller._updatePlayerState(PPVideoState.BUFFERING)},handlePlay:function(){this.bufferInterval||this.startBufferInterval();this.controller._updateIsPlaying(true);this.controller._updatePlayerState(PPVideoState.PLAYING)},handlePause:function(){this.controller._updateIsPlaying(false);this.video.currentTime==0&&
this.video.paused?this.controller._updatePlayerState(PPVideoState.STOPPED):this.controller._updatePlayerState(PPVideoState.PAUSED)},handleSeek:function(){this.controller._updateIsPlaying(false);this.controller._updatePlayerState(PPVideoState.SEEKING)},handleSeeked:function(){this.video.paused?this.handlePause():this.handlePlay()},handleEnd:function(){this.controller._updateIsPlaying(false);this.controller._updatePlayerState(PPVideoState.STOPPED);this.controller._complete()},handleVolume:function(){this.controller._updateVolume(this.video.volume)}}),
FlashVideoProxy=Class.create(PPProxy,{initialize:function($super,b,c,d){$super(b,c,d);this.setVolume(this.model.getVolume());this.resize()},setVideo:function(a){this.video=a},load:function(a){a?this.video._load(a):this.video._load()},play:function(a){a?this.video._play(a):this.video._play()},pause:function(){this.video._pause()},stop:function(){this.video._stop()},seek:function(a){this.video._seek(a)},destroy:function($super){EventUtil.unbind(this.model.dispatcher,PPVideoEvent.RESIZE,this.resize.context(this));
EventUtil.unbind(this.model.dispatcher,PPVideoEvent.VOLUME_UPDATE,this.handleVolume.context(this));$super()},setWidth:function(a){this.video.width=typeof a=="string"?a:a+"px"},setHeight:function(a){this.video.height=typeof a=="string"?a:a+"px"},getVolume:function(){return this.video._getVolume()},setVolume:function(a){this.video._setVolume(a)},setTime:function(a){this.video._setTime(a)},isPlaying:function(){return this.video._isPlaying()},setListeners:function(){EventUtil.bind(this.model.dispatcher,
PPVideoEvent.RESIZE,this.resize.context(this));EventUtil.bind(this.model.dispatcher,PPVideoEvent.VOLUME_UPDATE,this.handleVolume.context(this))},handleVolume:function(){this.video._setVolume(this.model.getVolume())},resize:function(){this.setWidth(this.model.getWidth());this.setHeight(this.model.getHeight())}}),PPStartVideoButton=Class.create(PPControl,{build:function($super){$super();DOMUtil.addClass(this.element,"pp-start-video");DOMUtil.createElement("div",{className:"button"},this.element)},setListeners:function(){EventUtil.bind(this.element,
"click",this.handleClick.context(this))},destroy:function($super){EventUtil.unbind(this.element,"click",this.handleClick.context(this));$super()},handleClick:function(){this.model.getPlaying()?this.controller.pause():this.controller.play()}}),PPPlayPauseButton=Class.create(PPControl,{build:function($super){$super();DOMUtil.addClass(this.element,"pp-play-pause")},setListeners:function(){EventUtil.bind(this.element,"click",this.handleClick.context(this))},destroy:function($super){EventUtil.unbind(this.element,
"click",this.handleClick.context(this));$super()},handleClick:function(){this.model.getPlaying()?this.controller.pause():this.controller.play()}}),PPStopButton=Class.create(PPControl,{build:function($super){$super();DOMUtil.addClass(this.element,"pp-stop")},setListeners:function(){EventUtil.bind(this.element,"click",this.controller.stop.context(this.controller))},destroy:function($super){EventUtil.unbind(this.element,"click",this.controller.stop.context(this.controller));$super()}});
function MouseUtil(){}MouseUtil.getRelativeXFromEvent=function(a,b){for(var c=b.offsetLeft;b=b.offsetParent;)c+=b.offsetLeft;return a.clientX-c};
var PPProgressBar=Class.create(PPControl,{resizeType:function(){return PPControl.TYPE_FLEXIBLE},build:function($super){$super();DOMUtil.addClass(this.element,"pp-progress-bar");this.downloadBar=DOMUtil.createElement("div",{className:"pp-load-progress"},this.element);this.PPProgressBar=DOMUtil.createElement("div",{className:"pp-play-progress"},this.element);this.handle=DOMUtil.createElement("div",{className:"pp-handle"},this.element)},setListeners:function(){EventUtil.bind(this.element,"mousedown",
this.handleMouseDown.context(this));EventUtil.bind(this.controller.container,"resize",this.update.context(this));EventUtil.bind(this.model.dispatcher,PPVideoEvent.LOAD_PROGRESS,this.update.context(this));EventUtil.bind(this.model.dispatcher,PPVideoEvent.TIME_UPDATE,this.update.context(this))},update:function(){var a;a=this.model.getBytesLoaded()/this.model.getBytesTotal()*this.element.offsetWidth;if(!isNaN(a))this.downloadBar.style.width=a+"px";a=this.model.getTime()/this.model.getDuration()*this.element.offsetWidth;
if(!isNaN(a))this.PPProgressBar.style.width=a+"px"},destroy:function($super){EventUtil.unbind(this.element,"mousedown",this.handleMouseDown.context(this));EventUtil.unbind(this.controller.container,"resize",this.update.context(this));EventUtil.unbind(this.model.dispatcher,PPVideoEvent.LOAD_PROGRESS,this.update.context(this));EventUtil.unbind(this.model.dispatcher,PPVideoEvent.TIME_UPDATE,this.update.context(this));EventUtil.unbind(this.container,"mousemove",this.handleMouseMove.context(this));EventUtil.unbind(document,
"mouseup",this.handleMouseUp.context(this));$super()},handleMouseDown:function(){EventUtil.bind(this.container,"mousemove",this.handleMouseMove.context(this));EventUtil.bind(document,"mouseup",this.handleMouseUp.context(this))},handleMouseMove:function(a){a=MouseUtil.getRelativeXFromEvent(a,this.element);this.handle.style.left=a+"px";this.model.getDuration()>0&&this.controller.seek(a/parseInt(this.element.offsetWidth)*this.model.getDuration())},handleMouseUp:function(a){this.handleMouseMove(a);EventUtil.unbind(this.container,
"mousemove",this.handleMouseMove.context(this));EventUtil.unbind(document,"mouseup",this.handleMouseUp.context(this))}}),PPTimeDisplay=Class.create(PPControl,{initialize:function($super,b,c,d){this.totalTime=this.currentTime=false;$super(b,c,d)},build:function($super){$super();DOMUtil.addClass(this.element,"pp-time-display");this.currentTime=DOMUtil.createElement("span",{className:"pp-current-time"},this.element);this.separator=DOMUtil.createElement("span",{className:"pp-time-separator"},this.element);
this.totalTime=DOMUtil.createElement("span",{className:"pp-total-time"},this.element)},setListeners:function(){EventUtil.bind(this.model.dispatcher,PPVideoEvent.TIME_UPDATE,this.update.context(this))},update:function(){this.currentTime.innerHTML=this.formatTime(this.model.getTime());this.totalTime.innerHTML=this.formatTime(this.model.getDuration())},destroy:function($super){EventUtil.unbind(this.model.dispatcher,PPVideoEvent.TIME_UPDATE,this.update.context(this));$super()},formatTime:function(a){var b=
parseInt(a%60);a=parseInt(a/60%60);return this.formattedDigit(parseInt(a/60))+":"+this.formattedDigit(a)+":"+this.formattedDigit(b)},formattedDigit:function(a){return a<10?"0"+a:a}}),PPVolumeControl=Class.create(PPControl,{initialize:function($super,b,c,d){this.PPProgressBar=this.wrapper=false;this.numBars=7;this.barWidth=3;this.maxBarHeight=15;this.lastMouseX=0;$super(b,c,d)},build:function($super){$super();DOMUtil.addClass(this.element,"pp-volume");this.wrapper=DOMUtil.createElement("div",{className:"pp-volume-wrapper"},
this.element);for(var b=0;b<this.numBars;b++){var c=Math.ceil(b/this.numBars*this.maxBarHeight),d=this.maxBarHeight-c,e=DOMUtil.createElement("div",{},this.wrapper);e.style.marginTop=d+"px";e.style.width=this.barWidth+"px";e.style.height=c+"px"}this.update()},setListeners:function(){EventUtil.bind(this.element,"mousedown",this.handleMouseDown.context(this));EventUtil.bind(this.model.dispatcher,PPVideoEvent.VOLUME_UPDATE,this.update.context(this))},canSupportPlatform:function(){return!(!EnvironmentUtil.iOS||
!EnvironmentUtil.android)},update:function(){for(var a=this.wrapper.children.length,b=Math.round(this.model.getVolume()*a),c=0;c<a;c++){var d=this.wrapper.children[c];c<=b?DOMUtil.addClass(d,"on"):DOMUtil.removeClass(d,"on")}},destroy:function($super){EventUtil.unbind(this.element,"mousedown",this.handleMouseDown.context(this));EventUtil.unbind(this.model.dispatcher,PPVideoEvent.VOLUME_UPDATE,this.update.context(this));EventUtil.unbind(this.element,"mousemove",this.handleMouseMove.context(this));
EventUtil.unbind(document,"mouseup",this.handleMouseUp.context(this));$super()},handleMouseDown:function(a){EventUtil.bind(this.element,"mousemove",this.handleMouseMove.context(this));EventUtil.bind(document,"mouseup",this.handleMouseUp.context(this));this.handleMouseMove(a)},handleMouseMove:function(a){this.lastMouseX=a=MouseUtil.getRelativeXFromEvent(a,this.element);this.controller._updateVolume(a/this.wrapper.offsetWidth)},handleMouseUp:function(){this.controller._updateVolume(this.lastMouseX/
this.wrapper.offsetWidth);EventUtil.unbind(this.element,"mousemove",this.handleMouseMove.context(this));EventUtil.unbind(document,"mouseup",this.handleMouseUp.context(this))}}),PPFullscreenButton=Class.create(PPControl,{initialize:function($super,b,c,d){$super(b,c,d);this.viewportHeight=this.viewportWidth=0;this.origWidth=this.model.getWidth();this.origHeight=this.model.getHeight();this.origPosition=false;this.getViewportSize()},build:function($super){$super();DOMUtil.addClass(this.element,"pp-fullscreen")},
setListeners:function(){EventUtil.bind(this.element,"click",this.toggleFullscreen.context(this));EventUtil.bind(this.model.dispatcher,PPVideoEvent.TOGGLE_FULLSCREEN,this.handleFullscreen.context(this))},destroy:function($super){EventUtil.unbind(window,"resize",this.size.context(this));EventUtil.unbind(this.element,"click",this.toggleFullscreen.context(this));EventUtil.unbind(this.model.dispatcher,PPVideoEvent.TOGGLE_FULLSCREEN,this.handleFullscreen.context(this));$super()},handleFullscreen:function(){this.model.getFullscreen()?
this.enterFullscreen():this.exitFullscreen()},toggleFullscreen:function(){this.controller.setFullscreen(!this.model.getFullscreen())},size:function(){this.getViewportSize();this.controller.setSize(this.viewportWidth,this.viewportHeight)},enterFullscreen:function(){this.size();EventUtil.bind(window,"resize",this.size.context(this));DOMUtil.addClass(this.controller.container,"pp-fullscreen")},exitFullscreen:function(){EventUtil.unbind(window,"resize",this.size.context(this));this.controller.setSize(this.origWidth,
this.origHeight);DOMUtil.removeClass(this.controller.container,"pp-fullscreen")},getViewportSize:function(){if(typeof window.innerWidth!="undefined"){this.viewportWidth=window.innerWidth;this.viewportHeight=window.innerHeight}else if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0){this.viewportWidth=document.documentElement.clientWidth;this.viewportHeight=document.documentElement.clientHeight}else{this.viewportWidth=
document.getElementsByTagName("body")[0].clientWidth;this.viewportHeight=document.getElementsByTagName("body")[0].clientHeight}}}),ProxyPlayer=Class.create({VERSION:"0.0.1",initialize:function(a,b,c,d,e,f){if(typeof a==="string"){a=a.indexOf("#")>-1?a.slice(a.lastIndexOf("#")+1,a.length):a;this.container=document.getElementById(a)}else this.container=a;DOMUtil.addClass(this.container,"pp-video");this.player=DOMUtil.createElement("div",{className:"pp-player"},this.container);this.config=b||new PPVideoConfiguration;
this.sources=c||new ProxyPlayerSources;this.controlsClasses=d?d:ProxyPlayer.defaultControls?ProxyPlayer.defaultControls:[];this.overlayClasses=e?e:ProxyPlayer.defaultOverlays?ProxyPlayer.defaultOverlays:[];this.readyCallback=f;this._isReady=this._videoElement=this._isVideoEmbedded=this._isVideoReady=this.controls=this.PPProxy=this.model=false;this._lastState="";if(EnvironmentUtil.iOS){this.config.videoOptions.volume=1;if(EnvironmentUtil.iOS_3||EnvironmentUtil.iPhone)this.config.videoOptions.controls=
true}this._useHTMLVideo=ProxyPlayer.canBrowserPlayVideo();this.playerId=parseInt(Math.random()*1E5,10);ProxyPlayer.instances[this.playerId]=this;this.model=new PPVideoModel(this.container);this._addModelListeners();this._init()},destroy:function(){DOMUtil.removeClass(this.container,this.model.getState());this._removeModelListeners();this.PPProxy.destroy();if(this.controls){this.controls.destroy();delete this.controls;delete this.controlsContainer}this.container.innerHTML="";delete this.container;
delete this.player;delete this._videoElement;delete this.sources;delete this.config;delete this.controlsClasses;delete this.readyCallback;delete this.model;delete this.PPProxy;delete this.controls},load:function(){this.PPProxy.load.apply(this.PPProxy,arguments)},play:function(){this.PPProxy.play.apply(this.PPProxy,arguments)},pause:function(){this.PPProxy.pause()},stop:function(){this.PPProxy.stop()},seek:function(a){this.PPProxy.seek(parseFloat(a))},setNewConfiguration:function(a){this.reset();this.config=
a;this._init()},setNewSources:function(a){this.sources=a;if(this._useHTMLVideo){this.reset();this._init()}else{this.model.reset();this.PPProxy.load(this.sources.flashVideo);this.config.videoOptions.autoplay&&this.PPProxy.play()}},reset:function(){this.PPProxy.destroy();this._videoElement.parentNode.removeChild(this._videoElement);delete this.PPProxy;delete this._videoElement;if(this.controls){this.controls.destroy();this.controlsContainer.parentNode.removeChild(this.controlsContainer);delete this.controls;
delete this.controlsContainer}this.model.reset();this._isVideoEmbedded=this._isVideoReady=this._isReady=false},fallback:function(){console.log("fallback!");this.reset();this.player.innerHTML="";this._createAnchorTags(this.player)},setSize:function(a,b){this.model.setSize(a,b)},getTime:function(){return this.model.getTime()},getDuration:function(){return this.model.getDuration()},getWidth:function(){return this.model.getWidth()},setWidth:function(a){this.model.setWidth(a)},getHeight:function(){return this.model.getHeight()},
setHeight:function(a){this.model.setHeight(a)},getVolume:function(){return this.model.getVolume()},setVolume:function(a){this.model.setVolume(a)},getFullscreen:function(){return this.model.getFullscreen()},setFullscreen:function(a){this.model.setFullscreen(a)},getVideo:function(){return this._videoElement},_setVideo:function(a){if(this._videoElement=a)this._isVideoEmbedded=true},_videoReady:function(){this._isVideoReady=true;this._checkReady()},_checkReady:function(){this._isVideoReady&&this._isVideoEmbedded&&
this._startupVideo()},_updatePlayheadTime:function(a){this.model.setTime(a)},_updateDuration:function(a){this.model.setDuration(a)},_updateIsPlaying:function(a){this.model.setPlaying(a)},_updatePlayerState:function(a){this.model.setState(a)},_updateVolume:function(a){this.model.setVolume(a)},_updateLoadProgress:function(a,b){this.model.setBytesTotal(b);this.model.setBytesLoaded(a)},_complete:function(){EventUtil.dispatch(this.container,PPVideoEvent.COMPLETE)},_init:function(){this._videoElement=this._createVideo();
this._useHTMLVideo?this._videoReady():this.setSize(this.config.width,this.config.height)},_startupVideo:function(){if(!this._isReady){this._isReady=true;this.model.setSize(this.config.width,this.config.height);this.model.setVolume(this.config.videoOptions.volume);this.PPProxy=this._createVideoProxy();this._createControls();this._handleResize();this._updatePlayerState(PPVideoState.READY);this.readyCallback&&this.readyCallback.call(this,[this]);EventUtil.dispatch(this.container,PPVideoEvent.PLAYER_READY)}},
_createVideo:function(){return this._useHTMLVideo?this._createHTMLVideoObject():this._createFlashVideoObject()},_createHTMLVideoObject:function(){var a=document.createElement("video");ProxyPlayer.applyAttributes(a,this.config.videoOptions);a.width=this.model.getWidth();a.height=this.model.getHeight();this.sources.videos.sort(this._sortVideos);this._createSourceTags(a);this._createAnchorTags(a);this.player.appendChild(a);this._isVideoEmbedded=true;return a},_createSourceTags:function(a){for(var b=
this.sources.videos.length,c=0;c<b;c++){var d=this.sources.videos[c];d=this._createSourceTag(d.file,d.type);a.appendChild(d)}},_createSourceTag:function(a,b){var c=document.createElement("source");c.src=a;if(!EnvironmentUtil.android&&b!==undefined)c.type=b;return c},_sortVideos:function(a,b){var c=a.file.match(/.mp4/i)!==null,d=b.file.match(/.mp4/i)!==null;return c&&!d?-1:d?1:0},_createAnchorTags:function(a){for(var b=this.sources.videos.length,c=0;c<b;c++){var d=this.sources.videos[c],e=document.createElement("a");
e.href=d.file;e.setAttribute("data-type",d.type);e.innerHTML=d.label;a.appendChild(e)}},_createFlashVideoObject:function(){var a="player-wrapper-"+this.playerId,b="pp-player-"+this.playerId;DOMUtil.createElement("div",{id:a},this.player);this.config.flashOptions.attributes.id=b;this.config.flashOptions.variables.playerId=this.playerId;this.config.flashOptions.variables.src=this.sources.flashVideo;this.config.flashOptions.variables.autoplay=this.config.videoOptions.autoplay;this.config.flashOptions.variables.volume=
this.model.getVolume();swfobject.embedSWF(this.config.flashOptions.swf,a,this.config.width,this.config.height,this.config.flashOptions.version,this.config.flashOptions.expressInstall,this.config.flashOptions.variables,this.config.flashOptions.params,this.config.flashOptions.attributes);this._findFlashPlayer(b);return null},_findFlashPlayer:function(a){var b=this;b.flashFinderInterval=setInterval(function(){var c=document.getElementById(a);if(c){b._setVideo(c);b._checkReady();clearInterval(b.flashFinderInterval)}},
10)},_createControls:function(){this.controlsContainer=DOMUtil.createElement("div",{className:"pp-controls"},this.container);this.controls=new PPControls(this.model,this,this.controlsContainer,this.controlsClasses,this.overlayClasses)},_createVideoProxy:function(){return this._useHTMLVideo?new HTMLVideoProxy(this.model,this,this._videoElement):new FlashVideoProxy(this.model,this,this._videoElement)},_addModelListeners:function(){EventUtil.bind(this.model.dispatcher,PPVideoEvent.RESIZE,this._handleResize.context(this));
EventUtil.bind(this.model.dispatcher,PPVideoEvent.STATE_CHANGE,this._handleState.context(this))},_removeModelListeners:function(){EventUtil.unbind(this.model.dispatcher,PPVideoEvent.RESIZE,this._handleResize.context(this));EventUtil.unbind(this.model.dispatcher,PPVideoEvent.STATE_CHANGE,this._handleState.context(this))},_handleState:function(){DOMUtil.removeClass(this.container,this._lastState);this._lastState=this.model.getState();DOMUtil.addClass(this.container,this._lastState)},_handleResize:function(){var a=
this.model.getWidth(),b=this.model.getHeight();b=typeof b=="string"?b:b+"px";this.container.style.width=typeof a=="string"?a:a+"px";this.container.style.height=b}});ProxyPlayer.defaultControls=null;ProxyPlayer.defaultOverlays=null;ProxyPlayer.instances={};ProxyPlayer.canBrowserPlayVideo=function(){return document.createElement("video").play!==undefined};
ProxyPlayer.activateAll=function(a){for(var b=document.getElementsByClassName("pp-video"),c=0;c<b.length;c++){var d=b[c],e=d.getElementsByTagName("video").item(0);if(ProxyPlayer.canBrowserPlayVideo()){e.pause();e.src="";EnvironmentUtil.firefox_3&&e.load()}for(var f=new ProxyPlayerSources,g=d.getElementsByTagName("source"),i=0;i<g.length;i++){var h=g.item(i);f.addVideo(h.src,h.type,h.getAttribute("data-label"),h.getAttribute("data-flash-default")||false)}g={};var j;if(e.width)g.width=e.width;if(e.height)g.height=
e.height;if(e.getAttribute("data-flash-swf"))j=e.getAttribute("data-flash-swf");if(e.getAttribute("data-controls"))g.controls=e.getAttribute("data-controls");if(e.getAttribute("data-volume"))g.volume=e.getAttribute("data-volume");if(e.getAttribute("data-autoplay"))g.autoplay=e.getAttribute("data-autoplay");if(e.getAttribute("data-preload"))g.preload=e.getAttribute("data-preload");if(e.getAttribute("data-loop"))g.loop=e.getAttribute("data-loop");if(e.getAttribute("data-poster"))g.poster=e.getAttribute("data-poster");
if(e.getAttribute("data-src"))g.src=e.getAttribute("data-src");i=e.getAttribute("data-controls-list");var k;if(i!==undefined&&i!==null){i=i.replace(" ","");k=i.split(",")}h=e.getAttribute("data-overlays-list");var l;if(i!==undefined&&h!==null){h=h.replace(" ","");l=h.split(",")}e=new PPVideoConfiguration(e.width,e.height,g,j);d.innerHTML="";new ProxyPlayer(d,e,f,k,l,a)}};
ProxyPlayer.applyAttributes=function(a,b){for(var c in b){c=c.toLowerCase();if(c=="width"||c=="height")a[c]=parseInt(b[c],10);else if(!(c.match(/poster/i)!=null&&EnvironmentUtil.iOS&&EnvironmentUtil.iOS_3))if(b[c]&&typeof b[c]==="string"){if(b[c].toLowerCase()!=="false")a[c]=b[c]}else if(b[c])a[c]=b[c]}};document.getElementsByClassName=function(a){var b=[];a=RegExp("\\b"+a+"\\b");for(var c=this.getElementsByTagName("*"),d=0;d<c.length;d++)a.test(c[d].className)&&b.push(c[d]);return b};
